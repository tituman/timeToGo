javascript:var persNumber='7846';var persPass='KEPASS';var times=new Array();var kommenFound=false;var GMfound=false;var KMfound=false;var linearInTime;var lunchPeriod;var inHour;var inMinutes;var timeWorked;var timeWorked_ShortFR;var timeWorked10h;var dateText;var misids;var currentLinearTime;var indexOfDay;function doIt(){login();setTimeout('getTodaysTimes()',1000);setTimeout('clickWoche()',1500);setTimeout('addWoche()',3000);}
function addWoche(){var iframe=document.getElementById('app');var innerDoc=iframe.contentDocument||iframe.contentWindow.document;var cnt=0;var startCounting=false;var table=innerDoc.getElementsByClassName("dataTables_scrollFootInner");if(table==null){alert('table not found!');}
var weekstime=table[0].textContent||table[0].innerText;weekstime=weekstime.replace(/(\r\n|\n|\r)/gm,"");weekstime=weekstime.split('Summe')[1];var weekstimeMinutes=Math.floor(Number(weekstime)*60);var goal=linearInTime+lunchPeriod+((38.5*60)-weekstimeMinutes);var goalHours=parseInt(goal/60,10);var goalMins=goal-(goalHours*60);if(goalMins<10){goalMins="0"+goalMins;};var timeToLeaveAdjusted=goalHours+":"+goalMins;var sStringz="K: "+(inHour)+":"+(inMinutes)+"\nlunched: "+(lunchPeriod-12);if(isFriday()){sStringz=(sStringz)+"\n\ntime to leave (7:20): "+(timeWorked);sStringz=(sStringz)+"\ntime to leave adjusted for week (38.5 - worked time this week): "+(timeToLeaveAdjusted);}else{sStringz=(sStringz)+"\n\ntime to leave (7:50): "+(timeWorked);sStringz=(sStringz)+"\ntime to leave adjusted for Short Friday (8:30): "+(timeWorked_ShortFR);}
sStringz=(sStringz)+"\nMAX time to leave (10h): "+(timeWorked10h);var my1date=new Date();var current_hourInMins=my1date.getHours()*60;var current_minute=my1date.getMinutes();currentLinearTime=current_hourInMins+current_minute;var effectiveLinearTime=currentLinearTime-linearInTime-lunchPeriod;var workedHours=parseInt(effectiveLinearTime/60,10);var workedMinutes=effectiveLinearTime-workedHours*60;if(workedMinutes<10){workedMinutes="0"+(workedMinutes);};sStringz=(sStringz)+"\n\neffective work time until now: "+(workedHours)+":"+(workedMinutes);var timeMinus10Linear=(10*60)-effectiveLinearTime;var workedHoursMinus10=parseInt(timeMinus10Linear/60,10);var workedMinutesMinus10=timeMinus10Linear-workedHoursMinus10*60;if(workedMinutesMinus10<10){workedMinutesMinus10="0"+(workedMinutesMinus10);};sStringz=(sStringz)+"\nwork time until 10h: "+(workedHoursMinus10)+":"+(workedMinutesMinus10);if((my1date.getDay()>1)&&(my1date.getDay()<5)){var avgLinear=weekstimeMinutes/(my1date.getDay()-1);var avgHours=parseInt(avgLinear/60,10);var avgMinutes=Math.floor(avgLinear-(avgHours*60));if(avgMinutes<10){avgMinutes="0"+avgMinutes;};sStringz=(sStringz)+"\naverage worktime per day: "+(avgHours)+":"+(avgMinutes);}
paintCurrentTimeInTable(innerDoc.getElementById("table1"),my1date);alert(sStringz);}
function paintCurrentTimeInTable(table){var linearTimeInChunks=parseInt(currentLinearTime/15,10)+2;var rowIdx=indexOfDay+3;var colIdx=linearTimeInChunks;var row=table.rows[rowIdx];var col=row.cells[colIdx];col.style.background='#FF69B4';}
function login(){var iframe=document.getElementById('app');var innerDoc=iframe.contentDocument||iframe.contentWindow.document;var user=innerDoc.getElementsByName('user_id')[0];if(iframe==null||innerDoc==null||user==null){return;}
user.value=persNumber;var pwd=innerDoc.getElementsByName('password')[0];pwd.value=persPass;innerDoc.getElementById('submitButton').click();setTimeout('clickLogin()',250);}
function clickLogin(){var iframe=document.getElementById('app');var innerDoc=iframe.contentDocument||iframe.contentWindow.document;var elm=innerDoc.getElementById('menutext');elm.focus();simulateClick(elm);return;}
function clickWoche(){var iframe=document.getElementById('app');var innerDoc=iframe.contentDocument||iframe.contentWindow.document;var elm=innerDoc.getElementById('actionlinkdiv');elm.focus();simulateClick(elm);return;}
function clickMonatsauswertung(){var iframe=document.getElementById('app');var innerDoc=iframe.contentDocument||iframe.contentWindow.document;var elm=innerDoc.getElementById('actionlinkdiv_b');elm.focus();simulateClick(elm);return;}
function simulateClick(elm){var evt=document.createEvent("MouseEvents");evt.initMouseEvent("click",true,true,window,0,0,0,0,0,false,false,false,false,0,null);var canceled=!elm.dispatchEvent(evt);if(canceled){}else{}
return;}
function getTodaysTimes(){var iframe=document.getElementById('app');var innerDoc=iframe.contentDocument||iframe.contentWindow.document;var cnt=0;var startCounting=false;var table=innerDoc.getElementById("table1");if(table==null){alert('please login to ePZE -> Buchen -> today');return;}
for(var i=0,row;row=table.rows[i];i++){for(var j=0,col;col=row.cells[j];j++){var colInText=col.textContent||col.innerText;colInText=colInText.replace(/(\r\n|\n|\r)/gm,"");if(col.id=="K2"&&colInText=="K"&&!kommenFound){startCounting=true;kommenFound=true;}
if(col.id=="K2"&&colInText=="GM"){startCounting=true;if(GMfound){startCounting=false;}GMfound=true;}
if(col.id=="K2"&&(colInText=="KM")){startCounting=true;KMfound=true;}
if(startCounting){cnt=cnt+1;}
if(startCounting&&col.id=="T4"){var buchung=row.cells[j-cnt+1].textContent||row.cells[j-cnt+1].innerText;buchung=buchung.replace(/(\r\n|\n|\r)/gm,"");times[buchung]=colInText.split(":");startCounting=false;cnt=0;}}
if(KMfound){break;}}var x5Date=innerDoc.getElementsByName("x5");if(x5Date==null){alert('please login to ePZE -> Buchen -> today');return;}
dateText=x5Date[0].value||x5Date[0].textContent||x5Date[0].innerText;dateText=dateText.replace(/(\r\n|\n|\r)/gm,"");dateText=dateText.split("/");calc();}
function isFriday(){var myDate=new Date();myDate.setFullYear(dateText[0]);myDate.setMonth(dateText[1]-1);myDate.setDate(dateText[2]);indexOfDay=myDate.getDay();return(indexOfDay==5)?true:false;}
function calc(){if(kommenFound){inHour=parseInt(times["K"][0],10);inMinutes=parseInt(times["K"][1],10);}else{inHour=0;inMinutes=0;}
if(GMfound){var lunchOutHour=parseInt(times["GM"][0],10);var lunchOutMinutes=parseInt(times["GM"][1],10);}else{var lunchOutHour=0;var lunchOutMinutes=0;}
if(KMfound){var lunchInHour=parseInt(times["KM"][0],10);var lunchInMinutes=parseInt(times["KM"][1],10);}else{var lunchInHour=0;var lunchInMinutes=0;}
var outHour10h=10;var outMinutes10h=0;var outHour=7;var outHour_ShortFR=isFriday()?4:8;var outMinutes=isFriday()?20:50;var outMinutes_ShortFR=30;linearInTime=60*(inHour)+(inMinutes);var linearLunchOutTime=60*(lunchOutHour)+(lunchOutMinutes);var linearLunchInTime=60*(lunchInHour)+(lunchInMinutes);var linearOutTime=60*(outHour)+(outMinutes);var linearOutTime_ShortFR=60*(outHour_ShortFR)+(outMinutes_ShortFR);var linearOutTime10h=60*(outHour10h)+(outMinutes10h);lunchPeriod=linearLunchInTime-linearLunchOutTime+12;var linearMinutesWorked=linearInTime+(linearOutTime+lunchPeriod);var linearMinutesWorked_ShortFR=linearInTime+(linearOutTime_ShortFR+lunchPeriod);var linearMinutesWorked10h=linearInTime+(linearOutTime10h+lunchPeriod);var hoursWorked=parseInt(linearMinutesWorked/60,10);var minutesWorked=linearMinutesWorked-(hoursWorked*60);if(minutesWorked<10){minutesWorked="0"+minutesWorked;}
var hoursWorked_ShortFR=parseInt(linearMinutesWorked_ShortFR/60,10);var minutesWorked_ShortFR=linearMinutesWorked_ShortFR-(hoursWorked_ShortFR*60);if(minutesWorked_ShortFR<10){minutesWorked_ShortFR="0"+minutesWorked_ShortFR;}
var hoursWorked10h=parseInt(linearMinutesWorked10h/60,10);var minutesWorked10h=linearMinutesWorked10h-(hoursWorked10h*60);if(minutesWorked10h<10){minutesWorked10h="0"+minutesWorked10h;}
timeWorked=hoursWorked+":"+minutesWorked;timeWorked_ShortFR=hoursWorked_ShortFR+":"+minutesWorked_ShortFR;timeWorked10h=hoursWorked10h+":"+minutesWorked10h;if(inMinutes<10){inMinutes="0"+inMinutes;}}
doIt();void(null);